var C=(x,m,r)=>new Promise((l,f)=>{var t=n=>{try{u(r.next(n))}catch(c){f(c)}},g=n=>{try{u(r.throw(n))}catch(c){f(c)}},u=n=>n.done?l(n.value):Promise.resolve(n.value).then(t,g);u((r=r.apply(x,m)).next())});import{d as T,f as w,r as U,c as $,u as e,Z as P,_ as V,q as F,z as L,l as s,a8 as o,E as v,a0 as _,am as A,F as K}from"./vue-b9806415.js";import{u as q,a as O,b as G,L as R,_ as W}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-2ad6cda0.js";import{h as Z,aa as j,b as H,u as J}from"./index.js";import{aa as E,w as I,ab as Q,B as z,V as X,U as Y}from"./antd-0fea3d6a.js";const ne=T({__name:"LoginForm",setup(x){const m=X,r=Y,l=E.Item,f=I.Password,{t}=H(),{notification:g,createErrorModal:u}=J(),{prefixCls:n}=Z("login"),c=j(),{setLoginState:D,getLoginState:B}=q(),{getFormRules:M}=O(),S=w(),y=w(!1),k=w(!1),d=U({account:"vben",password:"123456"}),{validForm:N}=G(S),b=$(()=>e(B)===R.LOGIN);function h(){return C(this,null,function*(){const p=yield N();if(p)try{y.value=!0;const a=yield c.login({password:p.password,username:p.account,mode:"none"});a&&g.success({message:t("sys.login.loginSuccessTitle"),description:`${t("sys.login.loginSuccessDesc")}: ${a.realName}`,duration:3})}catch(a){u({title:t("sys.api.errorTip"),content:a.message||t("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${n}`)||document.body})}finally{y.value=!1}})}return(p,a)=>(P(),V(K,null,[F(s(W,{class:"enter-x"},null,512),[[L,b.value]]),F(s(e(E),{class:"p-4 enter-x",model:d,rules:e(M),ref_key:"formRef",ref:S,onKeypress:A(h,["enter"])},{default:o(()=>[s(e(l),{name:"account",class:"enter-x"},{default:o(()=>[s(e(I),{size:"large",value:d.account,"onUpdate:value":a[0]||(a[0]=i=>d.account=i),placeholder:e(t)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),s(e(l),{name:"password",class:"enter-x"},{default:o(()=>[s(e(f),{size:"large",visibilityToggle:"",value:d.password,"onUpdate:value":a[1]||(a[1]=i=>d.password=i),placeholder:e(t)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),s(e(r),{class:"enter-x"},{default:o(()=>[s(e(m),{span:12},{default:o(()=>[s(e(l),null,{default:o(()=>[s(e(Q),{checked:k.value,"onUpdate:checked":a[2]||(a[2]=i=>k.value=i),size:"small"},{default:o(()=>[v(_(e(t)("sys.login.rememberMe")),1)]),_:1},8,["checked"])]),_:1})]),_:1}),s(e(m),{span:12},{default:o(()=>[s(e(l),{style:{"text-align":"right"}},{default:o(()=>[s(e(z),{type:"link",size:"small",onClick:a[3]||(a[3]=i=>e(D)(e(R).RESET_PASSWORD))},{default:o(()=>[v(_(e(t)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(e(l),{class:"enter-x"},{default:o(()=>[s(e(z),{type:"primary",size:"large",block:"",onClick:h,loading:y.value},{default:o(()=>[v(_(e(t)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules","onKeypress"]),[[L,b.value]])],64))}});export{ne as _};
